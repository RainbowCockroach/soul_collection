/* ============================================================
   SENSE BREAK — Escalating visual glitch/horror effects
   Applied via .sense-break on <html>, phases added over time
   ============================================================ */

/* --- Scanline overlay (all phases) --- */
.sense-break::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 99999;
}

/* ============================================================
   PHASE 1 — "Something's wrong" (0-5s)
   ============================================================ */

/* Slow hue drift */
.sense-break-phase-1 {
  animation: sense-break-hue-slow 8s linear infinite;
}

@keyframes sense-break-hue-slow {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(360deg); }
}

/* Faint scanlines */
.sense-break-phase-1::after {
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.06) 2px,
    rgba(0, 0, 0, 0.06) 4px
  );
}

/* Subtle skew on some elements */
.sense-break-phase-1 *:nth-child(7n + 3) {
  transform: skew(0.5deg, 0.2deg);
}

.sense-break-phase-1 *:nth-child(11n + 5) {
  transform: skew(-0.3deg, 0.4deg);
}

/* ============================================================
   PHASE 2 — "Getting worse" (5-15s)
   ============================================================ */

/* Faster hue + slight saturation boost */
.sense-break-phase-2 {
  animation: sense-break-hue-medium 4s linear infinite;
}

@keyframes sense-break-hue-medium {
  0% { filter: hue-rotate(0deg) saturate(1.2); }
  100% { filter: hue-rotate(360deg) saturate(1.2); }
}

/* Stronger scanlines */
.sense-break-phase-2::after {
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.12) 2px,
    rgba(0, 0, 0, 0.12) 4px
  );
}

/* Chromatic aberration on text */
.sense-break-phase-2 h1,
.sense-break-phase-2 h2,
.sense-break-phase-2 p,
.sense-break-phase-2 span,
.sense-break-phase-2 a {
  text-shadow: 2px 0 rgba(255, 0, 0, 0.4), -2px 0 rgba(0, 255, 255, 0.4);
}

/* Image distortion */
.sense-break-phase-2 img {
  animation: sense-break-image-distort 3s ease-in-out infinite alternate;
}

@keyframes sense-break-image-distort {
  0% { transform: skew(0deg) scale(1); }
  25% { transform: skew(1deg, -0.5deg) scale(1.01); }
  50% { transform: skew(-0.5deg, 0.5deg) scale(0.99); }
  75% { transform: skew(0.8deg, -0.3deg) scale(1.005); }
  100% { transform: skew(-0.3deg, 0.8deg) scale(1.01); }
}

/* Glitch flicker on some elements */
.sense-break-phase-2 .div-3d-with-shadow:nth-child(odd) {
  animation: sense-break-glitch-flicker 0.3s step-end infinite;
}

@keyframes sense-break-glitch-flicker {
  0%, 90%, 100% { opacity: 1; }
  91% { opacity: 0.7; }
  93% { opacity: 1; }
  95% { opacity: 0.5; }
  97% { opacity: 0.9; }
}

/* Screen tear effect */
.sense-break-phase-2 body {
  animation: sense-break-tear 4s ease-in-out infinite;
}

@keyframes sense-break-tear {
  0%, 85%, 100% { clip-path: inset(0); transform: none; }
  86% { clip-path: inset(20% 0 60% 0); transform: translateX(5px); }
  87% { clip-path: inset(0); transform: none; }
  92% { clip-path: inset(50% 0 30% 0); transform: translateX(-8px); }
  93% { clip-path: inset(0); transform: none; }
}

/* ============================================================
   PHASE 3 — "Full sense break" (15s+)
   ============================================================ */

/* Fast hue rotation + contrast + saturation */
.sense-break-phase-3 {
  animation: sense-break-hue-fast 1.5s linear infinite;
}

@keyframes sense-break-hue-fast {
  0% { filter: hue-rotate(0deg) saturate(1.5) contrast(1.1); }
  50% { filter: hue-rotate(180deg) saturate(1.8) contrast(1.3); }
  100% { filter: hue-rotate(360deg) saturate(1.5) contrast(1.1); }
}

/* Intense scanlines */
.sense-break-phase-3::after {
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.2) 2px,
    rgba(0, 0, 0, 0.2) 4px
  );
  animation: sense-break-scanline-flicker 0.1s step-end infinite;
}

@keyframes sense-break-scanline-flicker {
  0% { opacity: 0.8; }
  50% { opacity: 1; }
}

/* Heavy chromatic aberration */
.sense-break-phase-3 h1,
.sense-break-phase-3 h2,
.sense-break-phase-3 p,
.sense-break-phase-3 span,
.sense-break-phase-3 a {
  text-shadow: 4px 0 rgba(255, 0, 0, 0.6), -4px 0 rgba(0, 255, 255, 0.6);
}

/* Everything wobbles */
.sense-break-phase-3 .div-3d-with-shadow {
  animation: sense-break-wobble 0.5s ease-in-out infinite alternate;
}

.sense-break-phase-3 .div-3d-with-shadow:nth-child(even) {
  animation-delay: -0.25s;
  animation-direction: alternate-reverse;
}

@keyframes sense-break-wobble {
  0% { transform: rotate(-0.5deg) translateX(-2px); }
  33% { transform: rotate(0.8deg) translateY(1px); }
  66% { transform: rotate(-0.3deg) translateX(2px); }
  100% { transform: rotate(0.6deg) translateY(-1px); }
}

/* Images go wild */
.sense-break-phase-3 img {
  animation: sense-break-image-wild 1s ease-in-out infinite alternate;
}

@keyframes sense-break-image-wild {
  0% { transform: skew(0deg) scale(1) rotate(0deg); }
  20% { transform: skew(2deg, -1deg) scale(1.02) rotate(0.5deg); }
  40% { transform: skew(-1.5deg, 1deg) scale(0.98) rotate(-0.3deg); }
  60% { transform: skew(1deg, -2deg) scale(1.01) rotate(0.8deg); }
  80% { transform: skew(-0.5deg, 1.5deg) scale(1.03) rotate(-0.5deg); }
  100% { transform: skew(1.5deg, -0.5deg) scale(0.99) rotate(0.3deg); }
}

/* Invert flash pulses */
.sense-break-phase-3 body {
  animation: sense-break-invert-flash 3s ease-in-out infinite, sense-break-breathe 2s ease-in-out infinite;
}

@keyframes sense-break-invert-flash {
  0%, 88%, 92%, 100% { filter: none; }
  89% { filter: invert(1); }
  91% { filter: invert(1); }
}

/* Breathing scale */
@keyframes sense-break-breathe {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.03); }
}

/* Intense screen tear */
.sense-break-phase-3 .page-detail {
  animation: sense-break-tear-intense 2s step-end infinite;
}

@keyframes sense-break-tear-intense {
  0%, 80%, 100% { clip-path: inset(0); transform: none; }
  81% { clip-path: inset(10% 0 70% 0); transform: translateX(10px); }
  82% { clip-path: inset(0); transform: none; }
  84% { clip-path: inset(40% 0 40% 0); transform: translateX(-15px); }
  85% { clip-path: inset(0); transform: none; }
  90% { clip-path: inset(60% 0 20% 0); transform: translateX(8px); }
  91% { clip-path: inset(0); transform: none; }
  95% { clip-path: inset(5% 0 85% 0); transform: translateX(-5px); }
  96% { clip-path: inset(0); transform: none; }
}

/* Ensure pointer-events still work */
.sense-break * {
  pointer-events: auto;
}
